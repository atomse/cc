;;; -*- Mode: Common-Lisp; -*-

(defmacro pass? (test value)
  `(format t "~a  ~:[FAIL~;pass~]~%" ',test (equal ,test ,value)))

(find-most-n-common-term 1 '((517 903) (519 901)))

(find-most-n-common-term 3 '((* (509) (6 16) (519 1000))
                             (* (509) (6 16) (616 903))
                             (* (517) (6 16) (511 1000))
                             (* (901) (6 16) (511 616))
                             (* (517) (6 16) (608 903))
                             (* (901) (6 16) (519 608))
                             (* (608) (6 16) (517 903))
                             (* (608) (6 16) (519 901))))

(subgroup-terms '(608) '((* (509) (6 16) (519 1000))
                         (* (509) (6 16) (616 903))
                         (* (517) (6 16) (511 1000))
                         (* (901) (6 16) (511 616))
                         (* (517) (6 16) (608 903))
                         (* (901) (6 16) (519 608))
                         (* (608) (6 16) (517 903))
                         (* (608) (6 16) (519 901))))

(subgroup-terms '(608) '((* (509) (519 1000))
                         (* (509) (616 903))
                         (* (608) (517 903))
                         (* (608) (519 901))))
(regroup '((* (509) (519 1000))
           (* (509) (616 903) (708))
           (* (608) (517 903))
           (* (608) (519 901))))

(regroup '((* (509) (6 16) (519 1000))
           (* (509) (6 16) (616 903))
           (* (517) (6 16) (511 1000))
           (* (901) (6 16) (511 616))
           (* (517) (6 16) (608 903))
           (* (901) (6 16) (519 608))
           (* (608) (6 16) (517 903))
           (* (608) (6 16) (519 901))))
